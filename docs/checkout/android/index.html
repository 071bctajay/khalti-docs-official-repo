<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Android - Khalti Gateway Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Android";
    var mkdocs_page_input_path = "checkout/android.md";
    var mkdocs_page_url = "/checkout/android/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Khalti Gateway Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Welcome</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../getting-started/">Getting started</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Integration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../web/">Web</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Android</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#installation">Installation</a></li>
    

    <li class="toctree-l3"><a href="#usage">Usage</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#layout">Layout</a></li>
        
            <li><a class="toctree-l4" href="#configure">Configure</a></li>
        
            <li><a class="toctree-l4" href="#available-config-preset-methods">Available Config Preset Methods</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#summary">Summary</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#xml-attribute">XML Attribute</a></li>
        
            <li><a class="toctree-l4" href="#public-methods">Public Methods</a></li>
        
            <li><a class="toctree-l4" href="#callback-methods">Callback Methods</a></li>
        
            <li><a class="toctree-l4" href="#more-implementations">More Implementations</a></li>
        
            <li><a class="toctree-l4" href="#changelog">Changelog</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../ios/">iOS</a>
                </li>
                <li class="">
                    
    <a class="" href="../prestashop/">Prestashop</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Verification</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/verification/">Verification</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/transaction/">Transaction</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../contribution/">Contribution</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Khalti Gateway Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Integration &raquo;</li>
        
      
    
    <li>Android</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Documentation of Khalti checkout for android</p>
<h2 id="installation">Installation</h2>
<p>Add the following line to <code>dependency</code> section in <code>build.gradle</code> file</p>
<pre><code>compile 'com.khalti:khalti-android:1.2.3'
</code></pre>

<p>It is recommended that you update your support libraries to the latest version. However, if you're unable to update the libraries add the following line instead.</p>
<pre><code>compile ('com.khalti:khalti-android:1.2.3') {
        transitive = true
    }
</code></pre>

<p>Note : We recommend you to use the latest version of <code>Build tools</code> and <code>Support libraries</code> for maximum compatibility. </p>
<p>In order to build and run this project, please use <code>Android Studio 3</code> and please note that the minimum <code>Build tools</code> and <code>Support libraries</code> version should be <code>27</code>.</p>
<pre><code>compileSdkVersion 27
buildToolsVersion '27.0.3'

compile 'com.android.support:appcompat-v7:27.0.2'
</code></pre>

<p>In order to add support library 27, add the Google's maven url in <code>build.gradle</code></p>
<pre><code>repositories {
        jcenter()
        mavenCentral()
        maven { url &quot;https://maven.google.com&quot; }
    }
</code></pre>

<p><code>Important</code> Add the lines below in android default config of 'build.gradle'</p>
<pre><code class="java">renderscriptTargetApi 20
renderscriptSupportModeEnabled true
</code></pre>

<h2 id="usage">Usage</h2>
<h3 id="layout">Layout</h3>
<p>You can add KhaltiButton to your xml layout</p>
<pre><code class="xml">&lt;khalti.widget.KhaltiButton
            android:id=&quot;@+id/khalti_button&quot;
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;/&gt;

</code></pre>

<p>And, Locate your xml Khalti Button in your Java</p>
<pre><code class="java">KhaltiButton khaltiButton = (KhaltiButton) findViewById(R.id.khalti_button);
</code></pre>

<p>Or, use it in Java</p>
<pre><code class="java">KhaltiButton khaltiButton = new KhaltiButton();
</code></pre>

<p>And, add this java KhaltiButton into your layout container.</p>
<h3 id="configure">Configure</h3>
<p>Configure Khalti Checkout by passing an instance of Config class</p>
<p>When instantiating Config class pass public key, product id, product name, product web url, amount (in paisa) and a new instance of OnCheckOutListener.</p>
<pre><code class="java">Config config = new Config(&quot;Public Key&quot;, &quot;Product ID&quot;, &quot;Product Name&quot;, &quot;Product Url&quot;, amount, new OnCheckOutListener() {

            @Override
            public void onSuccess(HashMap&lt;String, Object&gt; data) {
                Log.i(&quot;Payment confirmed&quot;, data+&quot;&quot;);
            }

            @Override
            public void onError(String action, String message) {
                Log.i(action, message);
            }
        });
</code></pre>

<p>Additionally, Config class also accepts a HashMap parameter which you can use to pass any additional data. Make sure you add a <code>merchant_</code> prefix in your map key.</p>
<pre><code class="java">HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();
        map.put(&quot;merchant_extra&quot;, &quot;This is extra data&quot;);

        Config config = new Config(&quot;Public Key&quot;, &quot;Product ID&quot;, &quot;Product Name&quot;, &quot;Product Url&quot;, amount, map, new OnCheckOutListener() {

            @Override
            public void onSuccess(HashMap&lt;String, Object&gt; data) {
                Log.i(&quot;Payment confirmed&quot;, data);
            }

            @Override
            public void onError(String action, String message) {
                Log.i(action, message);
            }
        });

</code></pre>

<h4 id="config">Config</h4>
<table>
<thead>
<tr>
<th>Constraint</th>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Required</td>
<td>Public key</td>
<td>String</td>
<td>Test or live public key which identifies the merchant</td>
</tr>
<tr>
<td>Required</td>
<td>Product identity</td>
<td>String</td>
<td>Unique product identifier at merchant</td>
</tr>
<tr>
<td>Required</td>
<td>Product name</td>
<td>String</td>
<td>Name of product</td>
</tr>
<tr>
<td>Optional</td>
<td>Product url</td>
<td>String</td>
<td>URL of product</td>
</tr>
<tr>
<td>Required</td>
<td>Amount (In PAISA)</td>
<td>Long</td>
<td>Amount to pay in PAISA. Minimum transaction amount is 1000 PAISA i.e. Rs 10</td>
</tr>
<tr>
<td>Optional</td>
<td>Mobile</td>
<td>String</td>
<td>Mobile number to be preset in mobile fields</td>
</tr>
<tr>
<td>Optional</td>
<td>Additional data</td>
<td>HashMap<String, String></td>
<td>Any additional data the merchant wishes to pass to the SDK</td>
</tr>
<tr>
<td>Required</td>
<td>OnCheckOutListener</td>
<td>interface</td>
<td>Java interface with 2 callback methods <code>onSuccess</code> &amp; <code>onError</code>. For more information see <a href="#callback-methods">Callback Methods</a></td>
</tr>
</tbody>
</table>
<p>Note : In order to preset mobile number, you can also use <code>config.setMobile()</code>.</p>
<h3 id="available-config-preset-methods">Available Config Preset Methods</h3>
<table>
<thead>
<tr>
<th>Constraint</th>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Optional</td>
<td><code>setMobile()</code></td>
<td>Preset mobile number</td>
</tr>
</tbody>
</table>
<h4 id="set-config">Set Config</h4>
<p>Finally set your config in your KhaltiButton.</p>
<pre><code class="java">khaltiButton.setCheckOutConfig(config);
</code></pre>

<h2 id="summary">Summary</h2>
<h4 id="xml-attribute">XML Attribute</h4>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>khalti:text</code></td>
<td>Text to display</td>
</tr>
<tr>
<td><code>khalti:button_style</code></td>
<td>Set the style of KhaltiButton from 2 options</td>
</tr>
</tbody>
</table>
<h4 id="public-methods">Public Methods</h4>
<table>
<thead>
<tr>
<th>Constraint</th>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Required</td>
<td><code>setCheckOutConfig(Config config)</code></td>
<td>Set configuration required by Khalti checkout</td>
</tr>
<tr>
<td>Optional</td>
<td><code>setText(String text)</code></td>
<td>Set text to display in KhaltiButton</td>
</tr>
<tr>
<td>Optional</td>
<td><code>setCustomView(View view)</code></td>
<td>Replace KhaltiButton's default view with your custom view</td>
</tr>
<tr>
<td>Optional</td>
<td><code>setButtonStyle(ButtonStyle buttonStyle)</code></td>
<td>Select between 2 options to set KhaltiButton's style</td>
</tr>
<tr>
<td>Optional</td>
<td><code>showCheckOut()</code></td>
<td>Use this method to show Khalti checkout UI</td>
</tr>
<tr>
<td>Optional</td>
<td><code>destroyCheckOut()</code></td>
<td>Use this method to close Khalti checkout UI</td>
</tr>
</tbody>
</table>
<h4 id="callback-methods">Callback Methods</h4>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>onSuccess(HashMap data)</code></td>
<td>This method is called when a transaction has been completed and confirmed by the user. A map containing an access token, required to verify the transaction and data passed through Config instance is returned. Once this method is called, use the access token to verify the transaction. Please follow the <a href="../../api/verification/">verification</a> process for further instructions.</td>
</tr>
<tr>
<td><code>onError(String action, String message)</code></td>
<td>This method is called when an error occurs during payment initiation and confirmation. Action and message value is passed where action defines, the current action being performed and message defines the error.</td>
</tr>
</tbody>
</table>
<h5 id="response-sample">Response Sample</h5>
<h6 id="success-messsage">Success Messsage</h6>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>mobile</td>
<td>98XXXXXXXX</td>
<td>String</td>
</tr>
<tr>
<td>product_name</td>
<td>Product Name</td>
<td>String</td>
</tr>
<tr>
<td>product_identity</td>
<td>Product Id</td>
<td>String</td>
</tr>
<tr>
<td>product_url</td>
<td>Product Url</td>
<td>String</td>
</tr>
<tr>
<td>amount</td>
<td>100</td>
<td>Long</td>
</tr>
<tr>
<td>token</td>
<td>token</td>
<td>String</td>
</tr>
</tbody>
</table>
<p>The success message also contains all the <code>key</code> and <code>value</code> provide as extra data while initiating <code>Config</code> </p>
<h6 id="error-messsage">Error Messsage</h6>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>action</td>
<td>Action performed - initiate, confirm</td>
<td>String</td>
</tr>
<tr>
<td>message</td>
<td>Detail Error Message</td>
<td>String</td>
</tr>
</tbody>
</table>
<h4 id="more-implementations">More Implementations</h4>
<h5 id="method-1-with-custom-click-listener">Method 1: With Custom Click Listener</h5>
<p>Initialize the KhaltiCheckout Object</p>
<pre><code class="java">KhaltiCheckOut khaltiCheckOut = new KhaltiCheckOut(this, config);
</code></pre>

<p>Use <code>khaltiCheckout.show()</code> to display khalti widget</p>
<pre><code class="java">khaltiButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                khaltiCheckOut.show();
            }
        });
</code></pre>

<h5 id="method-2-with-custom-view">Method 2: With Custom View</h5>
<p>Get your custom view</p>
<pre><code class="java">View view = LayoutInflater.from(this).inflate(R.layout.custom_khalti_button, container, false);
</code></pre>

<p>Set custom view to your khalti button</p>
<pre><code class="java">khaltiButton.setCustomView(view);
khaltiButton.setCheckOutConfig(config);
</code></pre>

<p>Check out the source for <a href="https://github.com/khalti/khalti-sdk-android">Khalti checkout on Github</a>.</p>
<p>Check out the <a href="http://docs.khalti.com/api/verification/">Verification</a> process.</p>
<h3 id="changelog"><a href="https://github.com/khalti/khalti-sdk-android/blob/master/CHANGELOG.md">Changelog</a></h3>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ios/" class="btn btn-neutral float-right" title="iOS">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../web/" class="btn btn-neutral" title="Web"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../web/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ios/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
